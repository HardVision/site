<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/dashboard.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

    <link rel="stylesheet" href="../css/perfil.css">
</head>

<body onload="carregarInfo()">
   <div class="sidebar">

  <div class="perfil-container">
    <div class="foto-usuario">
      <i class="fa-solid fa-user"></i>
    </div>
    <div class="nome-usuario">Nome do Usuário</div>
    <div class="cargo-usuario">Cargo do Usuário</div>
  </div>

  <div class="nav-lateral">
    <a href="visaoGeral.html" class="nav-item"><i class="fa-solid fa-compass"></i> Visão Geral</a>
    <a href="dashboard.html" class="nav-item"><i class="fa-solid fa-chart-simple"></i> Monitoramento</a>
    <a href="alertas.html" class="nav-item"><i class="fa-solid fa-bell"></i> Alertas</a>
    <a href="metricas.html" class="nav-item"><i class="fa-solid fa-magnifying-glass-chart"></i> Métricas</a>
    <a href="perfil.html" class="nav-item ativo"><i class="fa-solid fa-user"></i> Perfil</a>
    <a href="../login.html" class="nav-item"><i class="fa-solid fa-door-open"></i> Sair</a>
  </div>

</div>

    <main class="conteudo">
        <header class="topo-alertas">
            <h2>Visão do perfil</h2>
        </header>
        <section>
            <div class="painel">
                <div class="painel-row">
                    <div class="painel-column" data-editable="true">
                        <h2>Nome</h2>
                        <h3 class="valor" id="nome">Rodrigo Bezerra</h3>
                    </div>
                    <div class="painel-column" data-editable="true">
                        <h2>Email</h2>
                        <h3 class="valor" id="email">rBezerra@gmail.com</h3>
                    </div>
                </div>

                <div class="painel-row">
                    <div class="painel-column" data-editable="true">
                        <h2>Telefone</h2>
                        <h3 class="valor" id="telefone">11 99025 3378</h3>
                    </div>
                    <div class="painel-column" data-editable="true">
                        <h2>CPF</h2>
                        <h3 class="valor" id="cpf">123.456.789.11</h3>
                    </div>
                </div>

                <div class="painel-row">
                    <div class="painel-column">
                        <h2>Empresa</h2>
                        <h3 id="empresa">Uptech</h3>
                    </div>
                    <div class="painel-column">
                        <h2>Permissão</h2>
                        <h3 id="permissao">Admin</h3>
                    </div>
                </div>
                <div class="buttons">
                    <button id="editarPerfilBtn">Alterar perfil</button>
                    <button id="altSenhaBtn">Alterar Senha</button>
                </div>

            </div>

        </section>
    </main>

    <script src="../js/perfil.js"></script>
</body>

</html>

<script>
    const email = sessionStorage.EMAIL;
    const id = sessionStorage.ID;

    function carregarInfo() {

        const nome = document.getElementById("nome")
        const email = document.getElementById("email")
        const telefone = document.getElementById("telefone")
        const cpf = document.getElementById("cpf")
        const empresa = document.getElementById("empresa")
        const permissao = document.getElementById("permissao")

        fetch(`/perfil/buscarInfo/${id}`, {
            method: "GET",
            headers: {
                "Content-Type": "application/json"
            }
        })
        .then(resposta => {
            resposta.json()
            .then(json => {
                console.log(json)
                nome.innerHTML = `${json[0].nome}`
                email.innerHTML = `${json[0].email}`
                telefone.innerHTML = `${json[0].telefone}`
                cpf.innerHTML = `${json[0].cpf}`
                empresa.innerHTML = `${json[0].razaoSocial}`
                permissao.innerHTML = `${json[0].permissao}`
            })
        })
    }

    function salvar() {
        const nome = document.getElementById('nome');
        const email = document.getElementById('email');
        const telefone = document.getElementById('telefone');
        const cpf = document.getElementById('cpf');

        fetch(`/perfil/atualizar/${id}`, {
            method: "PUT",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                nomeServer: nome.value,
                emailServer: email.value,
                telefoneServer: telefone.value,
                cpfServer: cpf.value
            })
        })
        .then(resposta => {
            resposta.json()
            .then(json => {
                console.log(json)
            })
        })
    }
</script>